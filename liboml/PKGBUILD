# Contributor: Olivier Mehani <olivier.mehani@nicta.com.au>
pkgname=liboml
pkgver=2.8.0
pkgrel=1
pkgdesc="OML is a measurement library that allows to define measurement points inside applications"
arch=(i686 x86_64)
url="http://oml.mytestbed.net/"
license=('custom:MIT-Nicta')
depends=('libxml2' 'sqlite3' 'libpcap' 'popt')
makedepends=('git' 'autoconf>=2.69' 'automake>=1.12.1' 'libtool>=2.4.2' 'asciidoc')
checkdepends=('check')

build() {
  # OML in-repo packaging trick
  mkdir -p "$srcdir/$pkgname-$pkgver"
  cd "$srcdir/$pkgname-$pkgver"
  $startdir/fetch-source-tree.rb

  cd $startdir
  # Normal build
  cd "$srcdir/$pkgname-$pkgver"
	autoreconf -i
	./configure --prefix=/usr --with-doc
	make || return 1
}

check() {
  cd "$srcdir/$pkgname-$pkgver"
  make -k check
}

package() {
  cd "$srcdir/$pkgname-$pkgver"
  make DESTDIR="$pkgdir/" install
	install -D -m 0644 ${srcdir}/$_gitname/COPYING \
		${pkgdir}/usr/share/licenses/${pkgname}/COPYING
}
# vim:set ts=2 sw=2 et:
